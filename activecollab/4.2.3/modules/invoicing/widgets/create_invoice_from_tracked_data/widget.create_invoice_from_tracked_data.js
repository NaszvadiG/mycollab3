(function($){var public_methods={init:function(){return this.each(function(){var wrapper=$(this);wrapper.find("#tracked_data_sum_by").change(function(){wrapper.createInvoiceFromTrackedData("refresh_items_preview")});wrapper.createInvoiceFromTrackedData("refresh_items_preview");App.Wireframe.Events.bind("description_formats_updated."+wrapper.parents(".flyout_dialog:first").attr("id"),function(event,response){wrapper.createInvoiceFromTrackedData("refresh_items_preview")})})},refresh_items_preview:function(){var wrapper=$(this);var items_preview=wrapper.find("#invoice_items_preview");var indicator=wrapper.find("p.loading_indicator");if(indicator.length<1){indicator=$('<p class="loading_indicator"><img src="'+App.Wireframe.Utils.indicatorUrl()+'"> '+App.lang("Working")+"</p>").appendTo(items_preview)}var table=items_preview.find("table").hide();var tbody=table.find("tbody").empty();$.ajax({url:wrapper.data("previewItemsUrl"),type:"post",data:wrapper.find("form").serialize(),success:function(response){if(jQuery.isArray(response)){var counter=1;App.each(response,function(k,v){tbody.append('<tr><td class="num">#'+counter+'</td><td class="description">'+App.clean(v.description)+'</td><td class="center quantity">'+v.quantity+'</td><td class="center unit_cost">'+v.unit_cost+"</td></tr>");counter++});indicator.remove();table.show().find("tbody td").highlightFade()}}})}};var plugin_name="createInvoiceFromTrackedData";$.fn[plugin_name]=function(method){if(public_methods[method]){return public_methods[method].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof method==="object"||!method){return public_methods.init.apply(this,arguments)}else{$.error("Method "+method+" does not exist in jQuery."+plugin_name)}}}})(jQuery);