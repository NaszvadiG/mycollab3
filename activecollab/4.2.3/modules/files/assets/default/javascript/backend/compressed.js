/* Minified: jquery.flyoutFileForm.js */
jQuery.fn.flyoutFileForm=function(s){var settings=jQuery.extend({success:null,error:null,title:"",width:1000,success_event:null,stop_propagation:false,error_event:"async_operation_error"},s);return this.each(function(){var link=$(this);link.click(function(event){var dialog=App.widgets.FlyoutDialog.show({title:settings.title?settings.title:link.attr("title"),data:link.attr("href"),data_type:"url",min_height:"auto",width:settings.width,success:function(){var dialog_content=$(this);if(dialog_content.is("form")){var form=dialog_content}else{var form=dialog_content.find("form:first")}form.submit(function(){if(!App.widgets.FormPendingAction.init(form)){return false}if(!form.find('.upload_form_subform table.multiupload_table tbody input[type="hidden"]').length){App.Wireframe.Flash.error("Choose at least one file to upload");return false}App.widgets.FlyoutDialog.startProcessing(dialog);$.ajax({url:App.extendUrl(form.attr("action"),{skip_layout:1}),type:"post",data:form.serialize(),defaultErrorHandler:settings.error_event?true:false,dataType:"json",success:function(response){App.widgets.FlyoutDialog.stopProcessing(dialog);if(typeof(settings.success)=="function"){settings.success.apply(link[0],[response])}if(settings.success_event){App.Wireframe.Events.trigger(settings.success_event,[response])}App.widgets.FlyoutDialog.close(dialog)},error:function(response){App.widgets.FlyoutDialog.stopProcessing(dialog);if(typeof(settings.error)=="function"){settings.error.apply(link[0],[response])}}});return false})}});if(settings.stop_propagation){return false}else{event.preventDefault()}})})};
